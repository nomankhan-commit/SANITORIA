
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/myLayout.cshtml";
}

<section class="content">
    <div class="container-fluid">
        <!-- Small boxes (Stat box) -->
        <div class="row">
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-info">
                    <div class="inner">
                        <h3>@ViewBag.products</h3>

                        <p>Products</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-bag"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-success">
                    <div class="inner">
                        <h3>@ViewBag.vendors</h3>

                        <p>Vendors</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-warning">
                    <div class="inner">
                        <h3>@ViewBag.customers</h3>

                        <p>Customers</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-danger">
                    <div class="inner">
                        <h3>@ViewBag.companies</h3>

                        <p>Companies</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-pie-graph"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
        </div>

        <div class="row">
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-info">
                    <div class="inner">
                        <h3>@ViewBag.sp_Inventory</h3>

                        <p>Inventory</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-bag"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-success">
                    <div class="inner">
                        <h3>@ViewBag.warehouses</h3>

                        <p>Warehouse</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-warning">
                    <div class="inner">
                        <h3>@ViewBag.RFQs</h3>

                        <p>RFQ</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-danger">
                    <div class="inner">
                        <h3>@ViewBag.SalesOrders</h3>

                        <p>Sales Orders</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-pie-graph"></i>
                    </div>
                    <a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>
                </div>
            </div>
            <!-- ./col -->
        </div>

        <div class="row">

            <section class="col-lg-12 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            Date Wise Sales
                        </h3>
                    </div>

                    @*<div>
                        <label>Start</label> <input type="date" class="form-control startdatePWS" style="width:190px"/>
                        <label>End</label><input type="date" class="form-control enddatePWS" style="width:190px" />
                        <button type="button" id="PWSDone">filter</button>
                    </div>*@

                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="dateWiseSale" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>


        </div>

        <div class="row">

            <section class="col-lg-12 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            Product Wise Sales
                        </h3>
                    </div>

                    @*<div>
                        <label>Start</label> <input type="date" class="form-control startdatePWS" style="width:190px"/>
                        <label>End</label><input type="date" class="form-control enddatePWS" style="width:190px" />
                        <button type="button" id="PWSDone">filter</button>
                    </div>*@

                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="SalesData" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>


        </div>

        <div class="row">

            <section class="col-lg-12 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            Customer Wise Sales
                        </h3>
                    </div>


                    @*<div>
                        <label>Start</label> <input type="date" class="form-control startdateCWS" style="width:190px" />
                        <label>End</label><input type="date" class="form-control enddateCWS" style="width:190px" />
                        <button type="button" id="CWSDone">filter</button>
                    </div>*@

                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="customerWiseSale" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>


        </div>

        <div>
            <h5>Inventory</h5>
            <div id="grid"></div>
        </div>

        <div class="row">

            <section class="col-lg-6 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            Amount / Products
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="productsVtotal" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="col-lg-6 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            OnHand Qty
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="produtctVOnHand" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div class="row">

            <section class="col-lg-6 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            Active Customers
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="activeCustomer" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="col-lg-6 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            Active Company
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="activecompany" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div class="row">

            <section class="col-lg-6 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            Active WareHouse
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="activewherhouse" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="col-lg-6 connectedSortable">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="fas fa-chart-pie mr-1"></i>
                            ProductDemand
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="tab-content p-0">
                            <div class="chart tab-pane active" id="revenue-chart"
                                 style="position: relative; height: 300px;">
                                <div id="ProductDemand" height="300" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </div>

    </div><!-- /.container-fluid -->
</section>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
<script src="~/Scripts/MyScripts/devExhelper.js"></script>
<script src="~/Scripts/MyScripts/fin_common.js"></script>
<script src="~/Scripts/Lib/inventory.js"></script>
<script src="~/Scripts/MyScripts/AjaxHelper.js"></script>
<script src="~/Content/ThemeContent/jszip.js"></script>

<script>

    let data = @Html.Raw(Json.Encode(ViewBag.inventory));
    $(() => {

        inventory.loadGrid();
        debugger;

        let productsVtotal = @Html.Raw(Json.Encode(ViewBag.produtctVTotal));
        BarChart('#productsVtotal', productsVtotal, "Product", "total", "");

        let produtctVOnHand = @Html.Raw(Json.Encode(ViewBag.produtctVOnHand));
        BarChart('#produtctVOnHand', produtctVOnHand, "Product", "OnHand", "");



        let ActiveCompany = @Html.Raw(Json.Encode(ViewBag.ActiveCompany));
        pieChart('#activecompany', ActiveCompany, "Comapny", "ActiveCompany", "");
       
        let ActiveCustomer = @Html.Raw(Json.Encode(ViewBag.ActiveCustomer));
        pieChart('#activeCustomer', ActiveCustomer, "Name", "ActiveCustomer", "");
      
        let ActiveWherehouse = @Html.Raw(Json.Encode(ViewBag.ActiveWherehouse));
        pieChart('#activewherhouse', ActiveWherehouse, "warehouse", "ActiveWhereHouse", "");

        let ProductDemand = @Html.Raw(Json.Encode(ViewBag.ProductDemand));
        BarChart('#ProductDemand', ProductDemand, "P_name", "units", "",null, true);

        let SalesData = @Html.Raw(Json.Encode(ViewBag.SalesData));
        BarChart('#SalesData', SalesData, "Products", "Amount", "",null,true);
        BarChart('#customerWiseSale', SalesData, "Customer", "Amount", "",null,false);
        BarChart('#dateWiseSale', SalesData, "createDate", "Amount", "",null,false);


        $('#PWSDone').click(function () {

           let s = $('.startdatePWS').val();
           let e = $('.enddatePWS').val();
            debugger;

            ajaxHealper.ajaxProcessor('/Dashboard/filter', "json", "POST", JSON.stringify({date1:s,date2:e}), true, (e) => {
                debugger;
              

            });

        })

    });

    function BarChart(divid, dataSource, _argumentField, _valueField, _name, _color, rotated){

        $(divid).dxChart({
            dataSource,
            rotated: rotated,
            tooltip: {
                enabled: true,
                customizeTooltip(info) {
                    debugger;
                    return { text: info.argument + "-" + info.originalValue }
                }
            },
            series: {
                argumentField: _argumentField,
                valueField: _valueField,
                name: _name,
                type: 'bar',
                color: _color,
            },
        });

    }
    function pieChart(divid, dataSource, _argumentField, _valueField, _name, _color) {

        $(divid).dxPieChart({
            size: {
                width: 500,
            },
            palette: 'bright',
            dataSource,
            series: [
                {
                    argumentField: _argumentField,
                    valueField: _valueField,
                    label: {
                        visible: true,
                        connector: {
                            visible: true,
                            width: 1,
                        },
                    },
                },
            ],
            //title: 'Area of Countries',
            export: {
                enabled: false,
            },
            onPointClick(e) {
                const point = e.target;

                toggleVisibility(point);
            },
            onLegendClick(e) {
                const arg = e.target;

                toggleVisibility(this.getAllSeries()[0].getPointsByArg(arg)[0]);
            },
        });

    }
</script>